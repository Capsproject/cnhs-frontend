import{B as s,R as i,j as t}from"./index-5lqfJLIH.js";import{i as c}from"./auth.service-B5lVCyo6.js";import{u as T}from"./index.esm-CgSeYvOK.js";import{M as S}from"./index-DSZhpQ6j.js";const j={createEvent:async function(e){return await c.post("admin/events",e,{headers:{"Content-Type":"multipart/form-data"}}).then(a=>(s.success("Announcement successfully created"),a.data.data)).catch(a=>{a.response.status===500?s.error("Failed to create announcement"):s.error(a.response.data.message)})},geteventsList:async function(){return await c.get("/admin/events").then(e=>e.data.data).catch(e=>{e.response.status===500?s.error("Failed to fetch event"):s.error(e.response.data.message)})},updateEvent:async function(e){return await c.patch("admin/events",e,{headers:{"Content-Type":"multipart/form-data"}}).then(a=>(s.success("Announcement successfully updated"),a.data.data)).catch(a=>{s.error("Failed to update announcement"),console.error(a)})},deleteEvent:async function(e){return await c.delete(`admin/events/${e}`).then(a=>(s.success("Event successfully deleted"),a.data.data)).catch(a=>{s.error("Failed to delete event"),console.error(a)})}},D=e=>{var v,p;const[a,x]=i.useState(!1),{handleSubmit:N,register:o,reset:u,setValue:g,formState:{errors:n}}=T(),h=()=>{u(),d(null),e.handleClose()},[y,d]=i.useState(null),[k,m]=i.useState(null),b=N(async l=>{x(!0);const r=new FormData;r.append("title",l.title),r.append("message",l.message),r.append("image",k),r.append("event_date",l.event_date),r.append("event_time",l.event_time),e.formType==="add"?(await j.createEvent(r),u(),e.refetch(),d(null),m(null)):(await j.updateEvent(r),u(),d(null),m(null),e.handleClose()),x(!1),e.handleClose()}),E=l=>{var w;const r=(w=l.target.files)==null?void 0:w[0];if(r){const f=new FileReader;f.onloadend=()=>{d(f.result)},f.readAsDataURL(r),m(r)}else d(null)};return i.useEffect(()=>{if(console.log(e.formType),e.data){for(const[l,r]of Object.entries(e.data))g(l,r);d(e.data.banner_img)}},[e.formType,e.data,g]),t.jsx(S,{loading:a,title:e.formType==="add"?"Create Event":e.formType==="view"?"Event Detail":"Update Event",onCancel:h,onClose:h,open:e.show,...e.formType!=="view"?{okText:"Submit",onOk:b}:{footer:null},children:t.jsxs("form",{className:"flex flex-col gap-2",onSubmit:b,children:[t.jsxs("div",{className:"flex flex-col gap-2",children:[t.jsx("input",{className:n.title?"border border-red-400":"appearance-none block w-full  text-gray-700 border border-gray-200 rounded py-3 px-4 mb-3 leading-tight focus:outline-none focus:bg-white focus:border-gray-500",placeholder:"Event Title",...o("title",{required:!0}),type:"text",required:!0,...e.formType==="view"?{disabled:!0}:{}}),n.title?t.jsx("small",{className:"text-xs text-red-400",children:"Title is required"}):null]}),t.jsxs("div",{className:"flex flex-col gap-2",children:[t.jsx("input",{...e.formType==="view"?{disabled:!0}:{},className:n.message?"border border-red-400":"appearance-none block w-full  text-gray-700 border border-gray-200 rounded py-3 px-4 mb-3 leading-tight focus:outline-none focus:bg-white focus:border-gray-500",placeholder:"Event Description",...o("message",{required:!0}),type:"text",required:!0}),n.title?t.jsx("small",{className:"text-xs text-red-400",children:"Description is required"}):null]}),t.jsx("div",{className:"flex items-center w-full gap-5 justify-between flex-wrap",children:t.jsxs("div",{className:"flex flex-row gap-2",children:[t.jsx("input",{...e.formType==="view"?{disabled:!0}:{},className:n.message?"border border-red-400":"appearance-none block w-full  text-gray-700 border border-gray-200 rounded py-3 px-4 mb-3 leading-tight focus:outline-none focus:bg-white focus:border-gray-500",placeholder:"Event Date",...o("event_date",{required:!0}),type:"date",required:!0,value:(v=e.data)==null?void 0:v.event_date}),n.event_date?t.jsx("small",{className:"text-xs text-red-400",children:"Date is required"}):null,t.jsx("input",{...e.formType==="view"?{disabled:!0}:{},className:n.message?"border border-red-400":"appearance-none block w-full  text-gray-700 border border-gray-200 rounded py-3 px-4 mb-3 leading-tight focus:outline-none focus:bg-white focus:border-gray-500",placeholder:"Event Time",...o("event_time",{required:!0}),type:"time",value:(p=e.data)==null?void 0:p.event_time,required:!0}),n.event_time?t.jsx("small",{className:"text-xs text-red-400",children:"Time is required"}):null]})}),t.jsx("h1",{children:"Upload File"}),t.jsxs("div",{className:"flex items-center justify-center w-full",children:[t.jsxs("label",{className:"flex flex-col items-center justify-center w-full h-64 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 dark:hover:bg-gray-800 dark:bg-gray-700 hover:bg-gray-100 dark:border-gray-600 dark:hover:border-gray-500",children:[y?t.jsx("img",{src:y,alt:"Selected Image",className:"w-full h-full object-cover"}):t.jsx(t.Fragment,{children:t.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[t.jsx("svg",{className:"w-8 h-8 mb-4 text-gray-500 dark:text-gray-400","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 20 16",children:t.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 13h3a3 3 0 0 0 0-6h-.025A5.56 5.56 0 0 0 16 6.5 5.5 5.5 0 0 0 5.207 5.021C5.137 5.017 5.071 5 5 5a4 4 0 0 0 0 8h2.167M10 15V6m0 0L8 8m2-2 2 2"})}),t.jsxs("p",{className:"mb-2 text-sm text-gray-500 dark:text-gray-400",children:[t.jsx("span",{className:"font-semibold",children:"Click to upload"})," or drag and drop"]}),t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"SVG, PNG, JPG or GIF (MAX. 800x400px)"})]})}),t.jsx("input",{...o("image"),type:"file",className:"hidden",id:"imageSelect",onChange:E,...e.formType==="view"?{disabled:!0}:{}})]}),n.image?t.jsx("small",{className:"text-xs text-red-400",children:"Image is required"}):null]})]})})};export{D as E,j as a};
